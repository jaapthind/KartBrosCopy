<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Google Docs</title>
    <link id="favicon" rel="icon" type="image/x-icon" href="https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', Arial, sans-serif; }
        body { background: #000; height: 100vh; overflow: hidden; display: flex; align-items: center; justify-content: center; }

        /* --- THE TRUE MOLTEN RAINBOW ENGINE --- */
        #liquid-canvas {
            position: fixed;
            inset: 0;
            z-index: -1;
            /* This filter turns moving noise into thick, rainbow molten glass */
            filter: blur(4px) url(#molten-prism) contrast(1.5) brightness(1.2);
            background: #000;
        }

        canvas { width: 100%; height: 100%; display: block; }

        /* --- CHAT BOX (MEDIUM SIZE) --- */
        #chat-container {
            position: relative;
            z-index: 10;
            width: 420px;
            height: 600px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border-radius: 24px;
            box-shadow: 0 50px 100px rgba(0,0,0,0.8);
            overflow: hidden;
        }

        iframe { width: 100%; height: 100%; border: none; }

        /* --- GHOST MODE (IDENTICAL GOOGLE) --- */
        #ghost-mode {
            display: none;
            position: fixed;
            inset: 0;
            background: #fff;
            z-index: 9999999;
            flex-direction: column;
        }
        .g-nav { display: flex; justify-content: flex-end; padding: 15px 20px; gap: 15px; font-size: 13px; align-items: center; }
        .g-nav a { text-decoration: none; color: #000; }
        .g-avatar { width: 32px; height: 32px; border-radius: 50%; background: #1a73e8; color: #fff; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .g-main { flex: 1; display: flex; flex-direction: column; align-items: center; padding-top: 15vh; }
        .g-search { width: 584px; height: 46px; border: 1px solid #dfe1e5; border-radius: 24px; display: flex; align-items: center; padding: 0 15px; margin-top: 25px; }
        .g-input { flex: 1; border: none; outline: none; font-size: 16px; margin-left: 10px; }

        #boot-btn {
            position: fixed; inset: 0; background: #000; z-index: 99999999;
            display: flex; align-items: center; justify-content: center;
        }
        button.init { padding: 20px 50px; background: #fff; border: none; border-radius: 50px; font-weight: 900; cursor: pointer; }
    </style>
</head>
<body>

    <div id="boot-btn">
        <button class="init" onclick="launch()">INITIALIZE WORKSPACE</button>
    </div>

    <div id="ghost-mode">
        <div class="g-nav">
            <a href="#">Gmail</a> <a href="#">Images</a>
            <div class="g-avatar">A</div>
        </div>
        <div class="g-main">
            <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" width="272">
            <div class="g-search">
                <input type="text" id="g-search-bar" class="g-input">
            </div>
        </div>
    </div>

    <svg style="position: absolute; width:0; height:0;">
      <filter id="molten-prism">
        <feTurbulence type="fractalNoise" baseFrequency="0.01 0.01" numOctaves="2" seed="88" result="noise">
            <animate attributeName="baseFrequency" values="0.01 0.01; 0.015 0.015; 0.01 0.01" dur="15s" repeatCount="indefinite" />
        </feTurbulence>
        <feDisplacementMap in="SourceGraphic" in2="noise" scale="150" xChannelSelector="R" yChannelSelector="G" result="warped" />
        <feColorMatrix type="matrix" values="
            1.5 0.3 0 0 0
            0 1.5 0.3 0 0
            0.3 0 1.8 0 0
            0 0 0 1 0" />
      </filter>
    </svg>

    <div id="liquid-canvas"><canvas id="c"></canvas></div>

    <div id="chat-container">
        <iframe src="https://deadsimplechat.com/J4fFLy4Ek" id="chat-frame"></iframe>
    </div>

<script>
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const ghost = document.getElementById('ghost-mode');
    const gBar = document.getElementById('g-search-bar');
    const title = document.getElementById('page-title');
    const favicon = document.getElementById('favicon');
    
    let active = false;
    let blobs = [];

    function launch() {
        document.getElementById('boot-btn').style.display = 'none';
        active = true;
        resize();
        // Create huge overlapping flowing masses
        for(let i=0; i<15; i++) {
            blobs.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                r: 400 + Math.random() * 400,
                vx: (Math.random() - 0.5) * 1.5,
                vy: (Math.random() - 0.5) * 1.5,
                hue: Math.random() * 360
            });
        }
        loop();
    }

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.onresize = resize;

    function loop() {
        if(!active) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        blobs.forEach(b => {
            b.x += b.vx; b.y += b.vy;
            if(b.x < -b.r) b.x = canvas.width + b.r;
            if(b.x > canvas.width + b.r) b.x = -b.r;
            if(b.y < -b.r) b.y = canvas.height + b.r;
            if(b.y > canvas.height + b.r) b.y = -b.r;

            let g = ctx.createRadialGradient(b.x, b.y, 0, b.x, b.y, b.r);
            g.addColorStop(0, 'rgba(255,255,255,1)');
            g.addColorStop(1, 'rgba(0,0,0,0)');
            
            ctx.fillStyle = g;
            ctx.beginPath();
            ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
            ctx.fill();
        });
        requestAnimationFrame(loop);
    }

    // --- CRITICAL ESC FIX ---
    // This runs even if you are clicking inside the window or UI
    function toggleGhost() {
        const isHidden = ghost.style.display === 'none' || ghost.style.display === '';
        if (isHidden) {
            ghost.style.display = 'flex';
            title.innerText = "Google";
            favicon.href = "https://www.google.com/favicon.ico";
            gBar.focus();
        } else {
            ghost.style.display = 'none';
            title.innerText = "Google Docs";
            favicon.href = "https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico";
        }
    }

    window.addEventListener('keydown', (e) => {
        if (e.key === "Escape") toggleGhost();
    });

    // Handle Enter in Google Search
    gBar.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            const q = gBar.value.trim();
            if(q) window.location.href = `https://www.google.com/search?q=${encodeURIComponent(q)}`;
        }
    });

    // Auto-focus logic: If the iframe is clicked, we try to keep listening for ESC
    // Note: If the iframe is cross-origin, Esc won't work while focused on it.
    // Solution: We keep the page title as Google Docs so it looks safe regardless.
    setInterval(() => {
        if (document.activeElement.tagName === "IFRAME") {
            // If you're stuck in the chat, click anywhere on the rainbow to re-enable ESC
        }
    }, 500);

</script>
</body>
</html>
